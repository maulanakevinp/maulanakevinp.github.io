<!DOCTYPE html>
<html lang="id">
<head>
    <title>Kalkulator Belanja</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0, minimal-ui">
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="description" content="Kalkulator Belanja" />
    <meta name="keywords" content="Kalkulator belanja,kalkulator,Kalkulator,belanja,Belanja">
    <meta name="author" content="Maulana Kevin Pradana" />
    <!-- Favicon icon -->
    <link rel="icon" href="/assets/img/favicon.ico" type="image/x-icon">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css" integrity="sha384-B0vP5xmATw1+K9KRQjQERJvTumQW0nPEzvF6L/Z6nronJ3oUOFUFpCjEUQouq2+l" crossorigin="anonymous">
    <style>
        .card {
            transition: box-shadow 1s;
        }
        .card:hover {
            cursor: pointer;
            box-shadow: -4px -4px 20px rgba(0, 36, 90, 0.25),
                4px 4px 20px rgba(0, 191, 255, 0.25);
        }
    </style>
</head>
<body class="">
    <div class="container my-5">
        <h3 class="text-center mb-3">Kalkulator Belanja</h3>
        <div class="card mb-3">
            <div class="card-body">
                <form class="needs-validation" novalidate>
                    <div class="row">
                        <div class="col-md-4 mb-3">
                            <label class="form-label" for="item_belanja">Item Belanja</label>
                            <input type="text" class="form-control" id="item_belanja" placeholder="Masukkan Item Belanja" value="" required>
                            <div class="invalid-feedback">
                                item belanja wajib diisi.
                            </div>
                        </div>
                        <div class="col-md-4 mb-3">
                            <label class="form-label" for="qty">Qty</label>
                            <input type="number" class="form-control" id="qty" placeholder="Masukkan Qty" value="" required>
                            <div class="invalid-feedback">
                                qty wajib diisi.
                            </div>
                        </div>
                        <div class="col-md-4 mb-3">
                            <label class="form-label" for="harga">Harga</label>
                            <input type="number" class="form-control" id="harga" placeholder="Masukkan Harga" value="" required>
                            <div class="invalid-feedback">
                                harga wajib diisi.
                            </div>
                        </div>
                    </div>
                    <button class="btn btn-block btn-primary" type="submit">Simpan</button>
                </form>
            </div>
        </div>
        <div class="card">
            <div class="card-body">
                <div class="table-responsive">
                    <table id="table" class="table table-hover table-striped">
                        <thead>
                            <tr>
                                <th>Opsi</th>
                                <th>Item Belanja</th>
                                <th class="text-right">Jumlah</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                        <tfoot>
                            <tr>
                                <th colspan="2" class="text-right">Total</th>
                                <th id="total" class="text-right">Rp. 0</th>
                            </tr>
                        </tfoot>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/js/bootstrap.bundle.min.js" integrity="sha384-gtEjrD/SeCtmISkJkNUaaKMoLD0//ElJ19smozuHV6z3Iehds+3Ulb9Bn9Plx0x4" crossorigin="anonymous"></script>
    <script>
        // Example starter JavaScript for disabling form submissions if there are invalid fields
        (function() {
            'use strict';
            let total = 0;
            window.addEventListener('load', function() {
                // Fetch all the forms we want to apply custom Bootstrap validation styles to
                var forms = document.getElementsByClassName('needs-validation');
                // Loop over them and prevent submission
                var validation = Array.prototype.filter.call(forms, function(form) {
                    form.addEventListener('submit', function(event) {
                        event.preventDefault();
                        event.stopPropagation();
                        if (form.checkValidity() === true) {
                            const tabel = document.getElementById('table');
                            const row = table.insertRow(1);
                            let cell_opsi = row.insertCell(0);
                            let cell_item_belanja = row.insertCell(1);
                            let cell_jumlah = row.insertCell(2);
                            cell_jumlah.className = 'text-right';

                            let nama = document.getElementById('item_belanja').value;
                            let qty = parseInt(document.getElementById('qty').value);
                            let harga = parseInt(document.getElementById('harga').value);
                            let jumlah = qty * harga;

                            cell_opsi.innerHTML = `
                                <a href="#" data-jumlah="${jumlah}" class="hapus btn btn-sm btn-danger" title="Hapus">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-trash" viewBox="0 0 16 16">
                                        <path d="M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0V6z"/>
                                        <path fill-rule="evenodd" d="M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1v1zM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4H4.118zM2.5 3V2h11v1h-11z"/>
                                    </svg>    
                                </a>
                            `;
                            cell_item_belanja.innerHTML = `<div style="word-wrap: break-word;">${nama}<br>${qty} x ${new Intl.NumberFormat('id-ID').format(harga)}</div>`;
                            cell_jumlah.innerHTML = 'Rp. ' + new Intl.NumberFormat('id-ID').format(jumlah);
                            total = total + jumlah;
                            document.getElementById('total').innerHTML = 'Rp. ' + new Intl.NumberFormat('id-ID').format(total);
                            form.reset();
                            nama.focus();
                        }
                    }, false);
                });
            }, false);

            document.addEventListener('click', function(event) {
                if (event.target.classList.contains('hapus')) {
                    event.preventDefault();
                    const row = event.target.parentElement.parentElement;
                    let jumlah_pengurangan = parseInt(event.target.dataset.jumlah);
                    row.remove();
                    total = total - jumlah_pengurangan;
                    document.getElementById('total').innerHTML = 'Rp. ' + new Intl.NumberFormat('id-ID').format(total);
                }
            });
        })();

    </script>
</body>
</html>
